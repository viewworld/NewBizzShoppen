<% I18n.locale = (!@invoice.english_version or version == :copy)  ? :pl : :en %>
<div class="invoice_show <%= version == :original ? "original" : "copy" %>">

  <div class="type"><%= version == :original ? (t :original, :scope => :invoices) : (t :copy, :scope => :invoices) %></div>

  <div class="general_data">
    <table cellpadding="0" cellspacing="0">
      <tr><td class="h"><%= t :number, :scope => :invoices %>: </td><td><%= @invoice.number %>/<%=@invoice.creation_date.year%></td></tr>
      <tr><td class="h"><%= t :sale_date, :scope => :invoices %>: </td><td><%= @invoice.sale_date %></td></tr>
      <tr><td class="h"><%= t :payment_dd, :scope => :invoices %>: </td><td><%= @invoice.payment_deadline_date %></td></tr>
      <tr><td class="h"><%= t :creation_date, :scope => :invoices %>: </td><td><%= @invoice.creation_date %></td></tr>
    </table>
  </div>

  <div class="hInvoice"><%= t :invoice, :scope => :invoices %></div>

  <div class="sides">
        <table cellpadding="0" cellspacing="0">
        <tr><td class="bigger"><%= t :from, :scope => :invoices %></td><td class="bigger"><%= t :to, :scope => :invoices %></td></tr>
        <tr><td class="h"><%= @invoice.seller_name %></td><td class="h"><%= @invoice.customer_name %></td></tr>
        <tr><td><%= @invoice.seller_address %></td><td><%= @invoice.customer_address %></td></tr>
        <tr><td><%= @invoice.seller_vat_no %></td><td><%= @invoice.customer_vat_no %></td></tr>
        </table>
  </div>

  <div class="product_data">
    <table cellspacing="0" cellpadding="0">
      <thead>
      <tr>
        <td class="field_id">#</td>
        <td class="product_name"><%= t :product_name, :scope => :invoices %></td>
        <td class="qty"><%= t :qty, :scope => :invoices %></td>
        <td class="netto_price"><%= t :netto_price, :scope => :invoices %></td>
        <td class="netto_value"><%= t :netto_value, :scope => :invoices %></td>
        <td class="vat"><%= t :vat, :scope => :invoices %></td>
        <td class="vat_value"><%= t :vat_value, :scope => :invoices %></td>
        <td class="brutto_value r"><%= t :brutto_value, :scope => :invoices %></td>
      </tr>
      </thead>
      <tbody>

      <% @invoice.invoice_lines.each_with_index do |invoice_line, index| %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= invoice_line.name %></td>
            <td><%= invoice_line.quantity %> <%= invoice_line.unit %></td>
            <td><%= number_to_currency(invoice_line.netto_price, :unit => "") %></td>
            <td><%= number_to_currency(invoice_line.netto_value, :unit => "") %></td>
            <td><%= invoice_line.vat_rate.zero? ? (t :na, :scope => :invoices) : number_to_percentage(invoice_line.vat_rate*100, :precision => 0) %></td>
            <td><%= number_to_currency(invoice_line.vat_value, :unit => "") %></td>
            <td class="r"><%= number_to_currency(invoice_line.brutto_value, :unit=>"") %></td>
          </tr>
      <% end %>

      <tr class="space"><td colspan="8"></td></tr>

      <tr class="totals">
        <td class="empty" colspan="3"></td>
        <td class="totals_h h r"><%= t :total, :scope => :invoices %></td>
        <td><%= number_to_currency(@invoice.total_netto, :unit => "PLN") %></td>
        <td></td>
        <td><%= number_to_currency(@invoice.total_vat, :unit => "PLN") %></td>
        <td class="h r" ><%= number_to_currency(@invoice.total, :unit => "PLN") %></td>
      </tr>

      <tr class="space"><td colspan="8"></td></tr>

      <% @invoice.invoice_lines_grouped_by_vat_rate.each_with_index do |invoice_line, index| %>
          <tr class="totals">
            <td class="empty" colspan="3"></td>
            <% if index.zero? %>
                <td class="totals_h h r"><%= t :including, :scope => :invoices %></td>
            <% else %>
                <td class="empty"></td>
            <% end %>
            <td><%= number_to_currency(invoice_line.netto_value_sum, :unit => "PLN") %></td>
            <td><%= invoice_line.vat_rate.zero? ? (t :na, :scope => :invoices) : number_to_percentage(invoice_line.vat_rate*100, :precision => 0) %></td>
            <td><%= number_to_currency(invoice_line.vat_value_sum, :unit => "PLN") %></td>
            <td class="r"><%= number_to_currency(invoice_line.brutto_value_sum, :unit => "PLN") %></td>
          </tr>
      <% end %>

      </tbody>
    </table>
  </div>

  <div class="additional_data">
    <ul>
      <% if !@invoice.english_version or version == :copy %>
          <p><span class="h"><%= t :total_iw, :scope => :invoices %>:</span> <%= @invoice.total_in_words %></p>
      <% end %>
      <% if @invoice.english_version %>
          <p><span class="h"><%= t :vat_paid, :scope => :invoices %>
            :</span> <%= @invoice.vat_paid_in_customer_country == true ? t(:yesss) : t(:nooo) %> <%= "- #{@invoice.vat_text_in_customer_country}" if @invoice.vat_text_in_customer_country.present? %></p>
      <% end %>
      <p><span class="h"><%= t :pay_method, :scope => :invoices %>
        :</span> <%= @invoice.payment_method == "cash" ? (t :cash, :scope => :invoices) : (t :bank_transfer, :scope => :invoices) %>
      </p>
      <% if not @invoice.payment_method == "cash" %>
          <p><span class="h"><%= t :pay_account, :scope => :invoices %>
            :</span> <%= @invoice.payment_account_information.blank? ? "-" : @invoice.payment_account_information %>
          </p>
      <% end %>
    </ul>
  </div>

  <div class="signs">
  <table cellpadding="0" cellspacing="0">
    <thead>
    <tr>
      <td class="space"></td>
      <td class="h"><%= t :seller, :scope => :invoices %></td>
      <td class="space"></td>
      <td class="h"><%= t :customer, :scope => :invoices %></td>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td class="space"></td>
      <td><%= "."*50 %></td>
      <td class="space"></td>
      <td><%= "."*50 %></td>
    </tr>
    </tbody>
  </table>
  </div>

  <div class="status_data">
    <h2><%= t :status, :scope => :invoices %></h2>
    <ul>
      <li><label class="h"><%= t :creation_place, :scope => :invoices %></label><%= @invoice.creation_place %></li>
      <li><label class="h"><%= t :email_at, :scope => :invoices %></label><%= @invoice.emailed_at or "-" %></li>
      <li><label class="h"><%= t :paid_at, :scope => :invoices %></label><%= @invoice.paid_at or "-" %></li>
      <li><label class="h"><%= t :cashflow, :scope => :invoices %></label><%= number_to_currency(@invoice.cash_flow, :unit => " PLN")%></li>
    </ul>
    <div class="clear"></div>
  </div>
</div>