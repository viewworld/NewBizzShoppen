<column-mc:>

  <header><%= t("administration.invoices.show.view.header") %></header>

  <ul class="actions">
    <%= link_to_function t("administration.invoices.show.view.print_invoice"), '$("#invoice_container").printElement()', :icon => "print" %>
    <%= link_to t("administration.invoices.show.view.download_pdf"), administration_invoicing_invoice_path(@invoice, :format => :pdf), :icon => "pdf" %>
    <%= link_to t("administration.invoices.show.view.set_as_paid"), new_administration_invoicing_invoice_cash_flow_path(@invoice.id), :remote => true, :method => :get, :icon => "paid" %>
    <%= link_to t("administration.invoices.show.view.send"), new_administration_invoicing_invoice_mailing_path(@invoice), :remote => true, :method => :get, :icon => "send" %>
    <%= link_to t("administration.invoices.show.view.edit_invoice"), edit_administration_invoicing_invoice_path(@invoice), :icon => "edit" %>
    <%= link_to t("administration.invoices.show.view.go_back"), administration_invoicing_invoices_path, :icon => "back" %>
  </ul>

  <br/><h4><%= t("administration.invoices.show.view.status") %>: <%= @invoice.status.to_s.capitalize %></h4>

  <div class="invoice_container" id="invoice_container">
    <%= render :partial => "administration/invoicing/invoices/invoice_preview", :locals => {:version => :original} %> <hr/>
    <%= render :partial => "administration/invoicing/invoices/invoice_preview", :locals => {:version => :copy} %>
  </div>

  <% unless @invoice.payment_transactions.empty?  %>
  <h4><%= t("administration.invoices.show.view.payment_transactions.header") %></h4>
      <table id="invoices_table" class="generic">
        <thead>
            <th><%= t("administration.invoices.show.view.payment_transactions.type") %></th>
            <th><%= t("administration.invoices.show.view.payment_transactions.paid_at") %></th>
            <th><%= t("administration.invoices.show.view.payment_transactions.amount") %></th>
        </thead>
        <tbody>
            <% @invoice.payment_transactions.each do |payment_transaction| %>
            <tr>
              <td><%= payment_transaction.class.to_s == "PaypalTransaction" ? t("administration.invoices.show.view.payment_transactions.type_paypal") : t("administration.invoices.show.view.payment_transactions.type_manual") %></td>
              <td><%= payment_transaction.paid_at.strftime("%d-%m-%Y") %></td>
              <td><%= payment_transaction.amount %></td>
            </tr>
            <% end %>
        </tbody>
      </table>
  <% end %>

<div id="osx-modal-content" style="display:none">
  <div id="osx-modal-title">Title</div>
  <div id="osx-modal-data"></div>
</div>
<%= javascript_include_tag 'jquery.simplemodal.js', 'osx.js', 'jquery-ui-1.8.5.custom.min' %>


</column-mc:>