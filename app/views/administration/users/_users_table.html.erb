        <div class="fltr" id="total_users">
          <div class="frm_tiny fltr" style="margin-top: 22px">
            <div class="pdd_10">
              <p>
                <%= t("administration.users.index.view.total") %>: <strong><%= @total_users %></strong>
              </p>
            </div>
          </div>
        </div>

        <clb/>

          <table id="users_table" class="generic">
            <thead>
            <tr>
              <th class="hl"></th>
              <th class="no_pdd_lr"><%= check_box_tag "mark_all", 1, false, :onclick => "mark_all_cbs_with_selector(this)" %></th>
              <th><%= link_to t("administration.users.index.view.id"), order_for_scoped_search(:id) %></th>
              <th><%= link_to t("administration.users.index.view.roles"), order_for_scoped_search(:roles_mask) %></th>
              <th><%= link_to t("administration.users.index.view.first_name"), order_for_scoped_search(:first_name) %></th>
              <th><%= link_to t("administration.users.index.view.last_name"), order_for_scoped_search(:last_name) %></th>
              <th><%= link_to t("administration.users.index.view.company_name"), order_for_scoped_search(:company_name) %></th>
              <th><%= link_to t("administration.users.index.view.email"), order_for_scoped_search(:email) %></th>
              <th><%= link_to t("administration.users.index.view.age"), order_for_scoped_search(:age) %></th>
              <th><%= link_to t("administration.users.index.view.leads_bought"), order_for_scoped_search(:leads_purchased_counter) %></th>
              <th><%= link_to t("administration.users.index.view.unpaid_leads"), order_for_scoped_search(:unpaid_leads_counter) %></th>
              <th><%= link_to t("administration.users.index.view.leads_created"), order_for_scoped_search(:leads_created_counter) %></th>
              <th><%= link_to t("administration.users.index.view.leads_sold"), order_for_scoped_search(:leads_volume_sold_counter) %></th>
              <th><%= link_to t("administration.users.index.view.revenue"), order_for_scoped_search(:leads_revenue_counter) %></th>
              <th><%= link_to t("administration.users.index.view.payout"),order_for_scoped_search(:payout) %></th>
              <th class="ta_c"><%= t("administration.users.index.view.locked") %></th>
              <th class="ta_r"><%= t("administration.users.index.view.actions") %></th>
              <th class="hr"></th>
            </tr>
            </thead>
            <tfoot>
            <tr>
              <td class="fl"></td>
              <td colspan="16"></td>
              <td class="fr"></td>
            </tr>
            </tfoot>
            <tbody>
            <% users.each do |user| %>
                <tr class="<%= cycle("odd", "even") %>">
                  <td class="cl"></td>
                  <td class="no_pdd_lr"><%= check_box_tag("user_ids[]", user.id) unless user.id == current_user.id %></td>
                  <td class="ta_c"><%= user.id %></td>
                  <td><%= user.roles_as_text %></td>
                  <td><%= user.first_name %></td>
                  <td><%= user.last_name %></td>
                  <td><%= user.company_name %></td>
                  <td><%= user.email %></td>
                  <td class="ta_r"><%= user.age %></td>
                  <td class="ta_r"><%= user.leads_purchased_counter %></td>
                  <td class="ta_r"><%= user.unpaid_leads_counter %></td>
                  <td class="ta_r"><%= user.leads_created_counter %></td>
                  <td class="ta_r"><%= user.leads_volume_sold_counter %></td>
                  <td class="ta_r"><%= user.leads_revenue_counter %></td>
                  <td class="ta_r"><%= user.payout %></td>
                  <td class="ta_c">
                    <% unless user.id == current_user.id %>
                        <%= link_to user.locked_at.blank? ? t("administration.users.index.view.lock") : t("administration.users.index.view.unlock"), administration_user_path(user, {"user_#{user.role.to_s}".to_sym  => {:locked =>  user.locked_at.blank? ? "lock" : "unlock"}}), {:method => :put} %>
                    <% end %>
                  </td>
                  <td class="tda ta_r">
                    <ul-actions>
                      <li>
                        <%= link_to t("administration.users.index.view.edit"), edit_administration_user_path(user), :class => "default_action" %>
                      </li>
                      <li>
                        <%= link_to t("administration.users.index.view.delete"), administration_user_path(user), {:method => :delete, :confirm => t("administration.users.index.view.delete_confirmation_message")} %>
                      </li>
                      <% unless user.subaccounts.empty? %>
                          <li>
                            <%= link_to t("administration.users.index.view.subaccounts"), administration_users_path({:search => {:with_subaccounts => user.id}}) %>
                          </li>
                      <% end %>
                      <% if user.has_role?(:customer) %>
                          <li><%= link_to t("administration.users.index.view.create_invoice"), new_administration_invoicing_invoice_path(:invoice => {:user_id => user.id}) %></li>
                      <% end %>
                    </ul-actions>
                  </td>
                  <td class="cr"></td>
                </tr>
            <% end %>
            <tr class="pagination">
              <td colspan="18" class="ta_c">
                <div class="td_select_all">
                  <%= check_box_tag "mark_all", 1, false, :onclick => "mark_all_cbs_with_selector(this)" %>
                  <%= label_tag "mark_all", "select all" %>
                </div>
                <%= will_paginate users if !subaccounts_table %>
              </td>
            </tr>
            <tr class="main_actions">
              <td class="cl"></td>
              <td colspan="16" class="no_pdd_lr ta_l">
                <%= hidden_field_tag :route_to %>
                <%= hidden_field_tag :bulk_action_type %>
                <% if !subaccounts_table %>
                    <%= bt_link_to :invoice, t("administration.users.index.view.create_invoice"), "javascript:void(0)", :onclick => "$('#bulk_action_type').val('create_invoice'); submitBulkForm('#{administration_bulk_users_update_path}#PUT');", :id => "invoice_selected" %>
                <% end %>
                <%= bt_link_to :padlock, t("administration.users.index.view.lock_selected"), "javascript:void(0)", :onclick => "$('#bulk_action_type').val('lock'); submitBulkForm('#{administration_bulk_users_update_path}#PUT');", :id => "lock_selected" %>
                <%= bt_link_to :unlock, t("administration.users.index.view.unlock_selected"), "javascript:void(0)", :onclick => "$('#bulk_action_type').val('unlock'); submitBulkForm('#{administration_bulk_users_update_path}#PUT');", :id => "unlock_selected" %>
              </td>
              <td class="cr"></td>
            </tr>
            </tbody>
          </table>