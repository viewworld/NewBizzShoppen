<column-mc:>

  <header>Leads</header>

  <%= leads_table @leads, :show_checkboxes => false do |blocks| %>
      <% blocks.tools do |lead| %>
        <%= bt_link_to nil, t("administration.leads.index.view.edit"), edit_administration_lead_path(lead), :class => "default_action" %>
      <% end %>
      <% blocks.status_column do |lead| %>
         <%= status_or_status_change(lead) %>
      <% end %>
  <% end %>

<%
   cols = 15
-%>


<table id="leads" class="generic">
  <thead>
    <tr>
      <th class="hl"></th>

      <th><%= link_to t("leads.table.id"), order_for_scoped_search(:id) %></th>
      <th><%= link_to t("leads.table.header"), order_for_scoped_search(:header) %></th>
      <th class="ta_c"><%= link_to t("leads.table.purchase_value"), order_for_scoped_search(:purchase_value) %></th>
      <th class="ta_c"><%= link_to t("leads.table.price"), order_for_scoped_search(:price) %></th>

      <th class="ta_c"><%= t("leads.table.clicks") %></th>
      <th class="ta_c"><%= t("leads.table.exposures") %></th>
      <th class="ta_c"><%= t("leads.table.hottness") %></th>
      <th class="ta_c"><%= t("leads.table.novelty") %></th>
      <th class="ta_c"><%= link_to t("leads.table.sale_limit"), order_for_scoped_search(:sale_limit) %></th>

      <th class="ta_c"><%= link_to t("leads.table.sold"), order_for_scoped_search(:lead_purchases_counter) %></th>

      <th class="ta_c"><%= t("leads.table.paid_out") %></th>
      <th class="ta_c"><%= link_to t("leads.table.unsatisfactory_rating"), order_for_scoped_search(:has_unsatisfactory_rating) %></th>
      <th><%= link_to t("leads.table.status"), order_for_scoped_search(:published) %></th>

        <th class="ta_r">
          <%= t("leads.table.actions") %>
        </th>

      <th class="hr"></th>
    </tr>
  </thead>
  <tfoot>
  <tr>
    <td class="fl"></td>
    <td colspan="<%= cols + 1 %>"></td>
    <td class="fr"></td>
  </tr>
  </tfoot>
  <tbody>
      <% @leads.each do |lead| %>
        <tr id="lead_<%= lead.id %>" class="<%= cycle("odd", "even") %>">
          <td class="cl"></td>
          <td><%= lead.id %></td>
          <td><%= lead.header %></td>
          <td class="ta_c"><%= lead.clicks_count %></td>
          <td class="ta_c"><%= lead.exposures_count %></td>
          <td class="ta_c"><%= t("models.lead.hotness.lvl#{lead.hotness_level}") %></td>
          <td class="ta_c"><%= lead.published ? t("models.lead.novelty.lvl#{lead.novelty_level}") : "-" %></td>
          <td class="ta_c"><%= lead.sale_limit %></td>
          <td class="ta_c"><%= as_currency(lead.price,lead.currency) %></td>
          <td class="ta_c"><%= lead.lead_purchases_counter %></td>
          <td class="ta_c"><%= as_currency(lead.purchase_value,lead.currency) %></td>
          <th class="ta_c"></th>
          <th class="ta_c"></th>

          <td class="ta_c"><%= link_to lead.has_unsatisfactory_rating ? t("leads.listing.has_unsatisfactory_rating_yes") : t("leads.listing.has_unsatisfactory_rating_no"), current_user.has_role?(:agent) ? agents_lead_path(lead) : edit_administration_lead_path(lead, :anchor => "lead_rating")%></td>



            <td class="tda ta_r">
              tools
            </td>

          <td class="cr"></td>
        </tr>
      <% end %>

      <% if will_paginate %>
        <tr class="pagination">
          <td colspan="<%= cols + 3 %>" class="ta_c">
            <%= will_paginate collection, :previous_label => '&laquo;', :next_label => '&raquo;' %>
          </td>
        </tr>
      <% end %>

      </tbody>
  </table>
</column-mc:>