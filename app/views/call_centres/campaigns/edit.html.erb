<search-box:>
  <%= render :partial => "contacts/filter", :locals => {:search => @search, :path => edit_call_centres_campaign_path(@campaign)} %>
</search-box:>

<column-mc:>
  <header back="true" backurl="#{call_centres_campaigns_path}"><%= t("campaigns.edit.title") %></header>

  <%= render :partial => "campaigns/edit", :locals => {:namespace => :call_centres, :campaign => @campaign,
                                                       :path_to_assignment => call_centres_campaign_campaigns_users_path(@campaign),
                                                       :path_back => call_centres_campaigns_path} %>

  <br/>

  <header>
    <param:content>
      <%= t("campaigns.edit.title_contacts") %>
    </param:content>

    <param:actions>
      <%= form_tag administration_articles_path, :method => :post, :id => "form_new_article" do %>
          <ul class="header_actions">
            <li>
              <%= bt_link_to :plus, t("campaigns.edit.button_create_contact"), new_call_centres_campaign_contact_path(@campaign) %>
            </li>
            <li>
              <%= bt_link_to :pencil, t("campaigns.edit.button_manage_result_types"), call_centres_campaign_results_path(@campaign) %>
            </li>
            <li class="last">
              <%= bt_link_to :users, t("campaigns.edit.button_import_contacts"), new_call_centres_campaign_contact_path(@campaign, :type => "import") %>
            </li>
          </ul>
      <% end %>
    </param:actions>

  </header>

  <% form_tag batch_assign_call_centres_campaign_contacts_path(@campaign), :method => :post, :id => "batch_assign_form" do %>
      <%= select_tag "agent_id", options_for_select(@campaign.users.map { |u| [u.full_name, u.id] }) %>
      <%= hidden_field_tag "contact_ids", nil, :id => "hf_batch_assign" %>
      <%= bt_link_to nil, t("campaigns.edit.button_assign_selected_contacts"), "javascript:void(0)", :onclick => "set_contacts_id_hf('hf_batch_assign');$('#batch_assign_form').submit();" %>
  <% end %>

  <%= contacts_table @contacts, :show_checkboxes => true do |blocks| %>
      <% blocks.tools do |contact| %>
          <ul-actions>
            <li>
              <%= link_to t("campaigns.edit.edit_button"), edit_call_centres_campaign_contact_path(@campaign, contact), :class => "default_action" %>
            </li>
            <li>
              <%= link_to t("campaigns.edit.remove_button"), call_centres_campaign_contact_path(@campaign, contact), :confirm => t("campaigns.edit.remove_confirm"), :method => :delete %>
            </li>
          </ul-actions>
      <% end %>

      <% blocks.bottom do %>
          <%= bt_link_to :remove, t("campaigns.edit.button_remove_selected"), "javascript:void(0)", :onclick => "set_contacts_id_hf('hf_batch_remove');$('#batch_remove_form').submit();" %>
          <%= bt_link_to :remove, t("campaigns.edit.button_remove_assignment_for_selected"), "javascript:void(0)", :onclick => "set_contacts_id_hf('hf_batch_unassign');$('#batch_unassign_form').submit();" %>


          <% form_tag batch_assign_call_centres_campaign_contacts_path(@campaign), :method => :post, :id => "batch_unassign_form" do %>
              <%= hidden_field_tag "contact_ids", nil, :id => "hf_batch_unassign" %>
          <% end %>

          <% form_tag batch_remove_call_centres_campaign_contacts_path(@campaign), :method => :post, :id => "batch_remove_form" do %>
              <%= hidden_field_tag "contact_ids", nil, :id => "hf_batch_remove" %>
          <% end %>
      <% end %>

  <% end %>


</column-mc:>