<column-mc:>
  <header back="true" backurl="#{callers_campaigns_path}">
    <param:content>
      <%= t("agent_work_screen.index.title") %> - <%= @campaign.name %>
    </param:content>
    <param:actions>
      <div id="switch_campaign_form">
        <%= render :partial => "callers/agent_work_screen/switch_campaign_form", :locals => @locals %>
      </div>
    </param:actions>
  </header>

  <div id="flashes">
    <div class="flash flash_notice" style="display:none">
    </div>

    <div class="flash flash_alert" style="display:none">
    </div>
  </div>

  <%= t("agent_work_screen.index.contact_search_label") %> <%= text_field_tag "autocompleter", nil %>

  <a data-remote="true" data-method="get" id="autocomplter_result_form" href="" class="display:none"></a>

  <script language="javascript">
      $(document).ready(function() {
          jQuery.ajaxSetup({
              'beforeSend': function(xhr) {
                  xhr.setRequestHeader("Accept", "text/javascript")
              }
          });
          $("#autocompleter").autocomplete({
              url : 'callers/campaigns/<%= @campaign.id %>/contacts_for_search.js',
              mustMatch : false
          }
                  ).result(function(event, item) {
              $("#autocomplter_result_form").attr("href", "/callers/campaigns/<%= @campaign.id %>/agent_work_screen/contacts/"+item[1]).click();
          });

          $("#autocompleter").autocomplete('contacts_for_search', function(event, data, formatted) {
          });
      });

  </script>

  <div id="agent_work_screen_dashboard">
    <div id="contact_info">
      <%= render :partial => "callers/agent_work_screen/contact_form", :locals => @locals if @contact %>
    </div>

    <div id="call_info">
      <%= render :partial => "callers/agent_work_screen/call_interface", :locals => @locals if @contact %>
    </div>

    <br/>

    <div id="results_sheet">
      <%= render :partial => "callers/agent_work_screen/results_sheet", :locals => @locals %>
    </div>

    <div id="call_sheet" style="display:none">
      <%= render :partial => "callers/agent_work_screen/call_sheet", :locals => @locals %>
    </div>

    <div id="pending_calls" style="display:none">
      <%= render :partial => "callers/agent_work_screen/pending_calls", :locals => @locals %>
    </div>

    <div id="completed_contacts" style="display:none">
      <%= render :partial => "callers/agent_work_screen/completed_contacts", :locals => @locals %>
    </div>
  </div>

  <div id="agent_work_screen_call_result" style="display:none">

  </div>

  <div id="call_result_form">
    <%= render :partial => "callers/agent_work_screen/call_result_form", :locals => @locals %>
  </div>

</column-mc:>

<js:>
  <script type="text/javascript">
      <% if !@contact and @pending_contacts.any? %>
      display_notice("<%= escape_javascript(t("contacts.show.flash.you_have_only_callback_contacts")) %>", false);
      <% elsif !@contact%>
      display_notice("<%= escape_javascript(t("contacts.show.flash.you_have_no_contacts_assigned")) %>", false);
      <% end %>

      $("#change_campaign_id").live("change", function() {
          $(this).parents("form").submit()
      });

  </script>
</js:>

