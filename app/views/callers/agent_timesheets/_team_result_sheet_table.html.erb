<table class="generic timesheet">
  <thead>
  <tr>
    <th style="width: 180px"><%= t("agent_timesheets.index.week") %> <%= cweek.to_s %></th>
    <% team_result_sheet.commercial_days_of_week.each do |dow| %>
        <th colspan="<%= team_result_sheet.colspan %>" class="ta_c"><%= I18n.t("date.day_names")[dow] %></th>
    <% end %>
    <th colspan="<%= team_result_sheet.colspan %>"><%= t("agent_timesheets.index.total") %></th>
  </tr>
  <tr class="subheader_row">
    <th></th>
    <% team_result_sheet.days_of_week.each do %>
        <% if team_result_sheet.display_hours %>
            <th><%= t("agent_timesheets.index.team_result_sheet.time") %></th>
        <% end %>
        <% if team_result_sheet.display_results %>
            <th><%= t("agent_timesheets.index.team_result_sheet.results") %></th>
        <% end %>
        <% if team_result_sheet.display_value %>
            <th><%= t("agent_timesheets.index.team_result_sheet.value") %></th>
        <% end %>
        <% if team_result_sheet.display_cost %>
            <th><%= t("agent_timesheets.index.team_result_sheet.cost") %></th>
        <% end %>
    <% end %>
    <% if team_result_sheet.display_hours %>
        <th><%= t("agent_timesheets.index.team_result_sheet.time") %></th>
    <% end %>
    <% if team_result_sheet.display_results %>
        <th><%= t("agent_timesheets.index.team_result_sheet.results") %></th>
    <% end %>
    <% if team_result_sheet.display_value %>
        <th><%= t("agent_timesheets.index.team_result_sheet.value") %></th>
    <% end %>
    <% if team_result_sheet.display_cost %>
        <th><%= t("agent_timesheets.index.team_result_sheet.cost") %></th>
    <% end %>
  </tr>
  </thead>
  <tbody>
  <% team_result_sheet.agents.each do |agent| %>
      <tr>
        <td class="cell_week"><%= agent.screen_name %></td>
        <% team_result_sheet.days_of_week.each do |dow| %>
            <% if team_result_sheet.display_hours %>
                <td class="val_h number_to_hours"><%= team_result_sheet.hours.for_cweek(cweek).for_dow(dow).for_agents(agent).sum(:hours) %></td>
            <% end %>
            <% if team_result_sheet.display_results %>
                <td class="val_r number_to_results"><%= team_result_sheet.results.for_cweek(cweek).for_dow(dow).for_agents(agent).sum(:results) %></td>
            <% end %>
            <% if team_result_sheet.display_value %>
                <td class="val_v number_to_value"><%= team_result_sheet.value.for_cweek(cweek).for_dow(dow).for_agents(agent).sum(:value) %></td>
            <% end %>
            <% if team_result_sheet.display_cost %>
                <td class="val_c number_to_cost"><%= team_result_sheet.cost.for_cweek(cweek).for_dow(dow).for_agents(agent).sum(:cost) %></td>
            <% end %>
        <% end %>
        <% if team_result_sheet.display_hours %>
            <td class="total_h total_h_h number_to_hours"></td>
        <% end %>
        <% if team_result_sheet.display_results %>
            <td class="total_h total_h_r number_to_results"></td>
        <% end %>
        <% if team_result_sheet.display_value %>
            <td class="total_h total_h_v number_to_value"></td>
        <% end %>
        <% if team_result_sheet.display_cost %>
            <td class="total_c total_h_c number_to_cost"></td>
        <% end %>
      </tr>
  <% end %>

  <tr class="total_row">
    <td class="ta_l"><%= t("agent_timesheets.index.total") %></td>
    <% team_result_sheet.days_of_week.each do %>
        <% if team_result_sheet.display_hours %>
            <td class="total_v_h number_to_hours"></td>
        <% end %>
        <% if team_result_sheet.display_results %>
            <td class="total_v_r number_to_results"></td>
        <% end %>
        <% if team_result_sheet.display_value %>
            <td class="total_v_v number_to_value"></td>
        <% end %>
        <% if team_result_sheet.display_cost %>
            <td class="total_v_c number_to_cost"></td>
        <% end %>
    <% end %>
    <% if team_result_sheet.display_hours %>
        <td class="total_v_h number_to_hours"></td>
    <% end %>
    <% if team_result_sheet.display_results %>
        <td class="total_v_r number_to_results"></td>
    <% end %>
    <% if team_result_sheet.display_value %>
        <td class="total_v_v number_to_value"></td>
    <% end %>
    <% if team_result_sheet.display_cost %>
        <td class="total_v_c number_to_cost"></td>
    <% end %>
  </tr>

  </tbody>
</table>
