<div class="column_left">
  <div class="pdd_10 no_pdd_t">
    <fieldset class="inputs labels_ta_r labels_200">
      <ol>
        <%#= form.input :category_id, :as => :select, :collection => Category.all, :include_blank => false %>
        <%= form.input :header %>
        <%= form.input :description %>
        <%= form.input :hidden_description %>
        <%= form.input :fine_print %>
        picture<br/>
        upload material to download<br/>
        <%= form.input :start_date, :as => :string,
                       :wrapper_html => {:class => "date"},
                       :input_html => {:class => "datepicker", :value => deal.start_date},
                       :hint => t('models.result_field.date_format')%>
        <%= form.input :end_date, :as => :string,
                       :wrapper_html => {:class => "date"},
                       :input_html => {:class => "datepicker", :value => deal.end_date},
                       :hint => t('models.result_field.date_format')%>
        <%= form.input :price, :as => current_user.buyer? ? :hidden : :string %>
        <%= form.input :currency_id, :collection => currencies_for_select, :include_blank => false %>
      </ol>
    </fieldset>
  </div>
</div>

<div class="column_right">
  <div class="pdd_10 no_pdd_t">
    <fieldset class="inputs labels_ta_r">
      <ol class="align_inputs">
        <%= form.input :company_name %>
        <%= form.input :category_id, :disabled => categories.select { |c| !c.can_publish_leads? }.map(&:id),  :collection => nested_set_options(categories), :include_blank => false %>
        Logo<br/>
        <%= form.input :company_description %>
        <%= form.input :contact_name %>
        <%= form.input :email_address %>
        <%= form.input :phone_number %>
        <%= form.input :address_line_1 %>
        <%= form.input :address_line_2 %>
        <%= form.input :address_line_3 %>
        <%= form.input :zip_code %>
        <%= form.input :country_id, :as => :select, :collection => Country.all, :include_blank => false %>
        <%= form.input :region_id, :as => :select, :collection => Region.all, :include_blank => false %>
        <%= form.input :deal_url %>
      </ol>
    </fieldset>
  </div>
</div>

<% if current_user.buyer? %>
<clb/>

    <hl/>
    <div id="deal_templates">
      <div class="pdd_10">
        <div class="grid_210 fltl">&nbsp;</div>
        <div class="grid_240 fltl">
          <h3><%= t("buyer.deals.form.all_templates") %></h3>
          <%= select_tag "all_templates", options_for_select((LeadTemplate.with_category(current_user.deal_category_id).with_creator(current_user.id)-@deal.deal_templates).map { |c| [c.name, c.id] }), {:multiple => true, :size => 10, :style => "height:200px; width:250px;"} %>
        </div>

        <div class="grid_160 fltl" style="margin-right: 10px;margin-top:10px;">
          <p class="ta_c pdd_5 no_pdd_lr"><%= bt_link_to nil, t("administration.categories.form.move_users_right"), "javascript:move_selected('all_templates','deal_deal_template_ids_')", :id => "move_right" %></p>

          <p class="ta_c"><%= bt_link_to nil, t("administration.categories.form.move_users_left"), "javascript:move_selected('deal_deal_template_ids_','all_templates')", :id => "move_left" %></p>
        </div>

        <div class="grid_240 fltl">
          <h3><%= t("buyer.deals.form.selected_templates") %></h3>
          <%= select_tag "deal[deal_template_ids][]", options_for_select(@deal.deal_templates.map { |c| [c.name, c.id] }), {:multiple => true, :size => 10, :style => "height:200px; width:250px;"} %>
        </div>
        <clb/>
      </div>
    </div>
<% end %>

<clb/>

    <div class="nested_locale_container"></div>

    <%= form.fields_for :lead_translations, deal.lead_translations.select { |lt| lt.locale != I18n.locale.to_s } do |builder| %>
        <%= render :partial => "/shared/deals/deal_fields", :locals => {:f => builder} %>
    <% end %>

<clb/>


<div class="pdd_10 no_pdd_t" id="locale_picker_div">
  <fieldset class="inputs labels_ta_r labels_180">
    <ol class="align_inputs">
      <li class="header">
        <h3><%= t("shared.leads.form.additional_language") %></h3>
      </li>
      <li class="select">
        <%= form.label :locale, "New translation" %>
        <%= select_tag :locale, options_for_select(available_locales_list(deal.lead_translations)),
                       {:id => "locale_picker", :include_blank => true, :onchange => fields_for_deals_translations(form)} %>
      </li>
    </ol>
  </fieldset>
</div>
<hl/>

<js:>
  <script type="text/javascript">
      $(function() {
          $(".datepicker").datepicker({ dateFormat: 'yy-mm-dd' });
          $("#deal_description").counter({
          count: 'up',
          goal: 140
          });
      });
   var nestedFormsCount = <%= deal.lead_translations.reject{ |lt| lt.locale == I18n.locale.to_s }.size %>;
   var language_names = [];
   <% Locale.all.each do |locale| %>
    <%= "language_names['#{locale.code}'] = '#{t('models.locale.' + locale.code)}';" -%>
   <% end %>
  </script>
  <%= javascript_include_tag 'lead_translation_functions.js' %>
</js:>