@m24 @vouchers @is
Feature: Vouchers

  Scenario: When voucher is enabled for deal then 'get deal' request redirect to deal information request page, after click on "ok" user is redirected to paypal for payment

  Scenario: Lead is not displayed when max number of vouchers has been bought

  Scenario: If member (purchase manager) have paid subscription he can buy voucher

  Scenario: Voucher can by bought through paypal

  Scenario: When voucher is bought an invoice is generated and set to paid

  Scenario: When voucher is bought an invoice is send to user

  Scenario: When voucher is bought lead is created as normal, and pdf voucher is generated

  Scenario: When voucher is bought pdf voucher is send to user in confirmation mail

  Scenario: When voucher is bought then unique 9 digit/capital_letters code is generated

  Scenario: When voucher is bought user can display it on get deal page: fairdeals logo, company logo, deal name, heading picture voucher value (deal price) price paid (discounted deal price) valid until, detailed description, fine print, how to redeem, voucher number (?)

  Scenario: Admin can enable voucher for deal

  Scenario: Agent with deal maker role can enable voucher for deal

  Scenario: Call center with deal maker role can enable voucher for deal

  Scenario: Call center agent with deal maker role can enable voucher for deal

  Scenario: When deal has enabled voucher then admin/agent can edit how_to_redeem and valid_until (fix date or number of weeks from procurement date) and number of vouchers

  Scenario: When deal has enabled voucher then admin/agent can edit heading picture

  Scenario: Supplier can see voucher information but can not edit it

  Scenario: user (without being log in) can validate voucher on home page with button "validate voucher"

  Scenario: user can provide unique code and validate it after he click "validate voucher"

  Scenario: user receive proper message after voucher validation

  Scenario: user can use voucher after successful validation